<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/movie-card/movie-card.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/movie-card/movie-card.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React from "react";
import PropTypes from "prop-types";
import { Button, Card } from "react-bootstrap";
import { Link } from "react-router-dom";
import "./movie-card.scss";

/** 
 * Renders a Bootstrap card for a movie, including its poster image,
 * title, director, and a link to a detail page. Also includes a button
 * to add the movie to the logged-in user's favorites.
 *
 * @component
 * @param {Object} props - React props
 * @param {{_id: string, title: string, imagePath: string, director: string}} props.movie - Movie data
 * @param {string} [props.token] - Auth token for the logged-in user
 * @param {string} [props.userName] - Logged-in user's username
 * @param {function(Object):void} [props.onAddFavorite] - Callback fired with the updated user after adding a favorite
 * @returns {ReactElement} A card displaying movie info and actions
 */
export const MovieCard = ({ movie, token, userName, onAddFavorite }) => {
    const [adding, setAdding] = React.useState(false);
    const [added, setAdded] = React.useState(false);
    const [error, setError] = React.useState(null);

    React.useEffect(() => {
        // Placeholder: could be used to check if this movie
        // is already in the user's favorites when the component mounts
    }, []);

    /**
   * Adds the current movie to the logged-in user's favorites.
   *
   * Sends a POST request to the backend. On success, calls `onAddFavorite`
   * with the updated user object. On failure, updates the error state.
   *
   * @async
   * @function handleAddFavorite
   * @returns {Promise&lt;void>}
   */
    const handleAddFavorite = async () => {
        if (!token || !userName) {
            setError("You must be logged in to add favorites");
            return;
        }

        setAdding(true);
        setError(null);

        try {
            const response = await fetch(
                `https://mytomhanksapp-3bff0bf9ef19.herokuapp.com/users/${userName}/favorites/${movie._id}`,
                {
                    method: "POST",
                    headers: { Authorization: `Bearer ${token}` },
                }
            );

            if (!response.ok) {
                const errData = await response.json();
                throw new Error(errData.message || "Failed to add favorite");
            }

            const updatedUser = await response.json();
            setAdded(true);
            if (onAddFavorite) onAddFavorite(updatedUser);
        } catch (err) {
            setError(err.message);
        } finally {
            setAdding(false);
        }
    };

    return (
        &lt;Card className="h-100">
            &lt;Card.Img variant="top" src={movie.imagePath} />
            &lt;Card.Body className="movie-card-body">
                &lt;Card.Title>{movie.title}&lt;/Card.Title>
                &lt;Card.Text>{movie.director}&lt;/Card.Text>
                &lt;div style={{ display: "flex", gap: "10px", marginTop: "10px" }}>
                    &lt;Link to={`/${encodeURIComponent(movie._id)}`}>
                        &lt;Button className="movie-card-link" size="lg" variant="link">
                            Open
                        &lt;/Button>
                    &lt;/Link>

                    &lt;Button
                        onClick={handleAddFavorite}
                        disabled={adding || added}
                        variant={added ? "success" : "primary"}
                    >
                        {added ? "Added to Favorites" : adding ? "Adding..." : "Add to Favorites"}
                    &lt;/Button>
                &lt;/div>
                {error &amp;&amp; &lt;div style={{ color: "red", marginTop: "5px" }}>{error}&lt;/div>}
            &lt;/Card.Body>
        &lt;/Card>
    );
};

/**
 * Prop type validation for MovieCard props.
 */
MovieCard.propTypes = {
    movie: PropTypes.shape({
        _id: PropTypes.string.isRequired,
        title: PropTypes.string.isRequired,
        imagePath: PropTypes.string.isRequired,
        director: PropTypes.string.isRequired,
    }).isRequired,
    token: PropTypes.string,
    userName: PropTypes.string,
    onAddFavorite: PropTypes.func,
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#LoginView">LoginView</a></li><li><a href="global.html#MovieCard">MovieCard</a></li><li><a href="global.html#MovieView">MovieView</a></li><li><a href="global.html#ProfileView">ProfileView</a></li><li><a href="global.html#SignupView">SignupView</a></li><li><a href="global.html#clearFilter">clearFilter</a></li><li><a href="global.html#handleAddFavorite">handleAddFavorite</a></li><li><a href="global.html#handleBack">handleBack</a></li><li><a href="global.html#handleChange">handleChange</a></li><li><a href="global.html#handleDelete">handleDelete</a></li><li><a href="global.html#handleSubmit">handleSubmit</a></li><li><a href="global.html#handleUpdate">handleUpdate</a></li><li><a href="global.html#loadUser">loadUser</a></li><li><a href="global.html#moviesSlice">moviesSlice</a></li><li><a href="global.html#setDirectorFilter">setDirectorFilter</a></li><li><a href="global.html#setGenreFilter">setGenreFilter</a></li><li><a href="global.html#setMovies">setMovies</a></li><li><a href="global.html#store">store</a></li><li><a href="global.html#validate">validate</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun Sep 28 2025 20:44:19 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
